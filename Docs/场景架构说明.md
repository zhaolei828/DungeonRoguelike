# 场景架构说明

**创建时间**: 2025-10-16  
**状态**: ✅ 3个正式场景已通过MCP创建完成

---

## 📋 场景概览

项目采用**3场景架构**，符合Week 1-2原计划：

```
Assets/_Project/Scenes/
├── Boot.unity          ← 场景0: 启动初始化
├── MainMenu.unity      ← 场景1: 主菜单
└── Game.unity          ← 场景2: 游戏主场景
```

---

## 🎬 Boot.unity - 启动场景

**用途**: 游戏启动入口，初始化全局管理器

### 场景结构
```
Boot
└── GameSystems
    ├── GameManager (Singleton, DontDestroyOnLoad)
    ├── LevelManager (Singleton, DontDestroyOnLoad)
    └── TurnManager (Singleton, DontDestroyOnLoad)
```

### 功能
- 初始化所有Singleton管理器
- 自动加载MainMenu场景
- 标记为DontDestroyOnLoad，全局可用

### 配置步骤
1. ✅ 场景已创建
2. ✅ GameSystems对象已添加3个Manager组件
3. ⏳ 需要手动添加SceneLoader组件到GameSystems
4. ⏳ 配置SceneLoader：
   - Auto Load Next Scene: ✓
   - Next Scene Name: `MainMenu`
   - Delay Before Load: `0.5`

---

## 🎮 MainMenu.unity - 主菜单场景

**用途**: 游戏主菜单，选择开始游戏、设置等

### 场景结构
```
MainMenu
├── Main Camera (UI Camera)
├── EventSystem
└── Canvas
    └── (待添加UI元素)
```

### 功能
- 显示游戏标题
- 开始新游戏按钮
- 继续游戏按钮
- 设置、退出按钮

### 配置步骤
1. ✅ 场景已创建
2. ✅ Main Camera已配置
3. ✅ Canvas + EventSystem已添加
4. ⏳ 需要在Canvas下添加UI元素：
   - Title Panel (游戏标题)
   - New Game Button
   - Continue Button  
   - Settings Button
   - Quit Button

---

## 🕹️ Game.unity - 游戏主场景

**用途**: 实际游戏运行场景，地牢生成和战斗

### 场景结构
```
Game
├── Main Camera (Pixel Perfect Camera)
├── Grid
│   ├── GroundTilemap (Sorting Layer: Ground, Order: 0)
│   ├── WallTilemap (Sorting Layer: Walls, Order: 1)
│   └── DecorationTilemap (Sorting Layer: Decoration, Order: 2)
├── LevelRenderer (待添加组件)
├── EventSystem
└── Canvas (游戏内UI)
    └── (待添加HUD、PauseMenu等)
```

### 功能
- 地牢生成和渲染
- 玩家移动和战斗
- 游戏内UI (HUD、暂停菜单等)
- 相机跟随

### 配置步骤
1. ✅ 场景已创建
2. ✅ Grid + 3层Tilemap已配置
3. ✅ Main Camera已添加
4. ✅ Canvas + EventSystem已添加
5. ⏳ Main Camera配置：
   - Projection: `Orthographic`
   - Size: `10`
   - 添加Pixel Perfect Camera组件
6. ⏳ LevelRenderer对象添加组件：
   - Add Component → `LevelRenderer`
   - 配置Tilemap引用
7. ⏳ Canvas下添加UI：
   - HUD (血条、小地图等)
   - PauseMenu
   - GameOverScreen

---

## 🔄 场景流程

### 游戏启动流程

```
Unity启动
    ↓
Boot.unity 加载
    ↓
初始化所有Manager (Singleton)
    ↓
SceneLoader自动加载
    ↓
MainMenu.unity 显示
    ↓
用户点击"开始游戏"
    ↓
Game.unity 加载
    ↓
游戏循环运行
```

### Build Settings配置

**场景顺序**（重要！）:
1. Scene 0: `Assets/_Project/Scenes/Boot.unity`
2. Scene 1: `Assets/_Project/Scenes/MainMenu.unity`
3. Scene 2: `Assets/_Project/Scenes/Game.unity`

**设置方法**:
1. File → Build Settings
2. 按顺序拖入3个场景
3. 确保Boot.unity在最上面（Index 0）

---

## 🎯 Singleton管理器系统

### DontDestroyOnLoad机制

Boot场景中创建的Manager会标记为DontDestroyOnLoad：
- 在MainMenu和Game场景中自动可用
- 无需重复创建
- 保持游戏状态连续性

### Manager职责

**GameManager**:
- 游戏状态管理（Playing、Paused、GameOver）
- Hero引用
- Depth深度管理
- 游戏循环控制

**LevelManager**:
- 关卡生成
- 关卡切换
- 关卡清理

**TurnManager**:
- 回合制系统
- Actor队列管理
- 回合调度

---

## 下一步

1. **立即操作**（5-10分钟）:
   - 打开Unity Editor
   - 完成手动配置清单
   - 测试场景切换

2. **Week 5开发**:
   - 实现玩家移动系统
   - 完善Game场景的游戏逻辑
   - 添加HUD界面

---

**场景架构**: ✅ 完成  
**准备状态**: ✅ 可以开始Game场景开发  
**下一阶段**: Week 5 玩家系统

