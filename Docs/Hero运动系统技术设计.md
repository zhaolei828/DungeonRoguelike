# Hero 运动动画系统设计文档

## 问题分析

用户反馈: 运动起来怎么好像是有几张图在切换一样

### 根本原因
原系统使用瞬间移动(瞬间teleport到目标位置),这导致:

按键 -> 瞬间移动 -> 立即切换动画帧
导致视觉效果: 位置跳跃 + 多张图快速闪烁

---

## 解决方案: 平滑移动插值系统

### 设计理念

采用SPD(Shattered Pixel Dungeon)的Tweening运动系统:
- 瞬间移动: 不可取
- 0.3秒的平滑插值运动: 正确做法
- 运动过程中持续播放行走动画: 完全同步
- 运动结束后自动返回Idle: 自然过渡

### 运动流程

1. 用户按D键(向右)
2. PlayerInput检查冷却
3. Hero.TryMoveTo() 立即更新逻辑pos
4. Hero启动SmoothMoveTo协程
5. 协程在0.3秒内平滑插值位置
6. 同时播放WalkRight动画
7. 0.3秒后到达目标位置
8. 自动返回Idle动画

---

## 关键改进

 平滑运动: 使用Lerp+Time.deltaTime实现0.3秒过渡
 完全同步: 动画播放时长 = 运动时长
 自然缓动: Smoothstep函数确保加速度平滑
 逻辑分离: pos立即更新,transform.position平滑过渡
 协程管理: 支持运动中断和流畅切换

---

## 参数

- moveDuration: 0.3秒 (单次移动耗时)
- frameRate: 10fps (动画帧率)
- idleTimeout: 1秒 (停止后返回Idle延迟)

---

## 效果对比

修改前:
- 位置瞬间改变
- 动画频繁切换
- 视觉抖动不清晰

修改后:
- 位置平滑过渡
- 动画持续播放
- 视觉流畅自然
